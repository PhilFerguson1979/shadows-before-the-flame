// ── D&D 5e Feats Reference ──────────────────────────────────
// PHB + Tasha's Cauldron + Xanathar's Guide + Fizban's Treasury + Dragonlance feats
// Used by FeatManager, feat browse pages, and character creation

export interface Feat {
  name: string;
  slug: string;
  prerequisite?: string;
  description: string;
  benefits: string[];
  source: string;          // "PHB", "TCE", "XGE"
  halfFeat?: string;       // Which ability score gets +1 (if any)
  category: string;        // "Combat", "Spellcasting", "Utility", "Social", "Exploration", "Racial"
}

export const feats: Feat[] = [
  // ── PHB Feats ──
  {
    name: 'Alert',
    slug: 'alert',
    description: 'Always on the lookout for danger, you gain benefits that keep you vigilant.',
    benefits: [
      '+5 bonus to initiative',
      "Can't be surprised while conscious",
      'Other creatures don\'t gain advantage on attack rolls against you as a result of being unseen',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Athlete',
    slug: 'athlete',
    description: 'You have undergone extensive physical training.',
    benefits: [
      'Increase Strength or Dexterity by 1',
      'Standing up from prone costs only 5 feet of movement',
      'Climbing doesn\'t cost extra movement',
      'Running long/high jump requires only 5 feet of running start',
    ],
    source: 'PHB',
    halfFeat: 'str/dex',
    category: 'Exploration',
  },
  {
    name: 'Actor',
    slug: 'actor',
    description: 'Skilled at mimicry and dramatics, you gain benefits for deception and performance.',
    benefits: [
      'Increase Charisma by 1',
      'Advantage on Deception and Performance checks when pretending to be someone else',
      'Can mimic speech or sounds of other creatures heard for at least 1 minute',
    ],
    source: 'PHB',
    halfFeat: 'cha',
    category: 'Social',
  },
  {
    name: 'Charger',
    slug: 'charger',
    description: 'When you use your action to Dash, you can make a melee attack or shove as a bonus action.',
    benefits: [
      'After Dashing, bonus action melee attack with +5 damage',
      'Or bonus action to shove a creature up to 10 feet away',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Crossbow Expert',
    slug: 'crossbow-expert',
    description: 'Thanks to extensive practice with the crossbow, you are a deadly marksman.',
    benefits: [
      'Ignore loading property of crossbows you are proficient with',
      'No disadvantage on ranged attacks within 5 feet of a hostile creature',
      'When you Attack with a one-handed weapon, bonus action crossbow attack with hand crossbow',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Defensive Duelist',
    slug: 'defensive-duelist',
    prerequisite: 'Dexterity 13 or higher',
    description: 'When wielding a finesse weapon, you can add your proficiency bonus to AC against one melee attack.',
    benefits: [
      'Reaction: add proficiency bonus to AC against one melee attack that would hit you',
      'Must be wielding a finesse weapon you are proficient with',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Dual Wielder',
    slug: 'dual-wielder',
    description: 'You master fighting with two weapons.',
    benefits: [
      '+1 bonus to AC while dual wielding',
      'Can dual wield non-light one-handed melee weapons',
      'Can draw or stow two one-handed weapons at once',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Dungeon Delver',
    slug: 'dungeon-delver',
    description: 'Alert to hidden traps and secret doors, you gain exploration advantages.',
    benefits: [
      'Advantage on Perception and Investigation checks to detect secret doors',
      'Advantage on saving throws to avoid or resist traps',
      'Resistance to trap damage',
      'Can search for traps while traveling at normal pace',
    ],
    source: 'PHB',
    category: 'Exploration',
  },
  {
    name: 'Durable',
    slug: 'durable',
    description: 'Hardy and resilient, you gain constitution benefits.',
    benefits: [
      'Increase Constitution by 1',
      'When rolling hit dice to regain HP, minimum value equals twice your CON modifier',
    ],
    source: 'PHB',
    halfFeat: 'con',
    category: 'Utility',
  },
  {
    name: 'Elemental Adept',
    slug: 'elemental-adept',
    prerequisite: 'Spellcasting feature',
    description: 'You gain mastery over a damage type, ignoring resistance and treating 1s as 2s.',
    benefits: [
      'Choose acid, cold, fire, lightning, or thunder',
      'Spells you cast ignore resistance to the chosen damage type',
      'When rolling damage for that type, treat any 1 on a die as a 2',
      'Can take this feat multiple times for different elements',
    ],
    source: 'PHB',
    category: 'Spellcasting',
  },
  {
    name: 'Grappler',
    slug: 'grappler',
    prerequisite: 'Strength 13 or higher',
    description: 'You develop the skills necessary to hold your own in close-quarters grappling.',
    benefits: [
      'Advantage on attack rolls against creatures you are grappling',
      'Can pin a creature grappled by you (both restrained until grapple ends)',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Great Weapon Master',
    slug: 'great-weapon-master',
    description: 'You can make devastating attacks with heavy weapons at the cost of accuracy.',
    benefits: [
      'On a critical hit or killing blow with a melee weapon, bonus action melee attack',
      'Before attacking with a heavy weapon: take -5 to hit for +10 damage',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Healer',
    slug: 'healer',
    description: 'You are an able physician, able to mend wounds and restore health.',
    benefits: [
      'Stabilize a creature and restore 1 HP using healer\'s kit',
      'Use healer\'s kit to restore 1d6 + 4 + creature\'s max hit dice HP (once per rest per creature)',
    ],
    source: 'PHB',
    category: 'Utility',
  },
  {
    name: 'Heavily Armored',
    slug: 'heavily-armored',
    prerequisite: 'Proficiency with medium armor',
    description: 'You train to wear heavy armor effectively.',
    benefits: [
      'Increase Strength by 1',
      'Gain proficiency with heavy armor',
    ],
    source: 'PHB',
    halfFeat: 'str',
    category: 'Combat',
  },
  {
    name: 'Heavy Armor Master',
    slug: 'heavy-armor-master',
    prerequisite: 'Proficiency with heavy armor',
    description: 'You use heavy armor to deflect strikes that would injure others.',
    benefits: [
      'Increase Strength by 1',
      'While wearing heavy armor, reduce nonmagical bludgeoning/piercing/slashing damage by 3',
    ],
    source: 'PHB',
    halfFeat: 'str',
    category: 'Combat',
  },
  {
    name: 'Inspiring Leader',
    slug: 'inspiring-leader',
    prerequisite: 'Charisma 13 or higher',
    description: 'You can spend 10 minutes inspiring companions, granting temporary HP.',
    benefits: [
      'Spend 10 minutes to give up to 6 friendly creatures temporary HP',
      'Temporary HP equals your level + CHA modifier',
      'A creature can only benefit once per short or long rest',
    ],
    source: 'PHB',
    category: 'Social',
  },
  {
    name: 'Keen Mind',
    slug: 'keen-mind',
    description: 'You have a mind that can track time, direction, and detail with uncanny precision.',
    benefits: [
      'Increase Intelligence by 1',
      'Always know which way is north',
      'Always know the number of hours left before sunset/sunrise',
      'Can accurately recall anything seen or heard within the past month',
    ],
    source: 'PHB',
    halfFeat: 'int',
    category: 'Utility',
  },
  {
    name: 'Lightly Armored',
    slug: 'lightly-armored',
    description: 'You have trained to master the use of light armor.',
    benefits: [
      'Increase Strength or Dexterity by 1',
      'Gain proficiency with light armor',
    ],
    source: 'PHB',
    halfFeat: 'str/dex',
    category: 'Combat',
  },
  {
    name: 'Linguist',
    slug: 'linguist',
    description: 'You have studied languages and codes extensively.',
    benefits: [
      'Increase Intelligence by 1',
      'Learn three languages of your choice',
      'Can create written ciphers that require INT check (DC = INT score) to decipher',
    ],
    source: 'PHB',
    halfFeat: 'int',
    category: 'Social',
  },
  {
    name: 'Lucky',
    slug: 'lucky',
    description: 'You have inexplicable luck that seems to kick in at just the right moment.',
    benefits: [
      '3 luck points per long rest',
      'Spend 1 luck point to roll additional d20 on attack, ability check, or save and choose which to use',
      'Can also force reroll on attack rolls against you',
    ],
    source: 'PHB',
    category: 'Utility',
  },
  {
    name: 'Mage Slayer',
    slug: 'mage-slayer',
    description: 'You have practiced techniques to combat spellcasters.',
    benefits: [
      'Reaction: melee attack against creature within 5 ft that casts a spell',
      'When you damage a concentrating creature, it has disadvantage on the save',
      'Advantage on saving throws against spells cast within 5 feet of you',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Magic Initiate',
    slug: 'magic-initiate',
    description: 'Choose a class and learn two cantrips and one 1st-level spell from that class.',
    benefits: [
      'Learn two cantrips from a chosen class spell list',
      'Learn one 1st-level spell from that class (cast once per long rest without a slot)',
      'Spellcasting ability depends on chosen class',
    ],
    source: 'PHB',
    category: 'Spellcasting',
  },
  {
    name: 'Martial Adept',
    slug: 'martial-adept',
    description: 'You have martial training that allows you to perform special combat maneuvers.',
    benefits: [
      'Learn two maneuvers from the Battle Master archetype',
      'Gain one superiority die (d6) that recharges on short/long rest',
      'Save DC = 8 + proficiency bonus + STR or DEX modifier',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Medium Armor Master',
    slug: 'medium-armor-master',
    prerequisite: 'Proficiency with medium armor',
    description: 'You have practiced wearing medium armor like a second skin.',
    benefits: [
      'No disadvantage on Stealth checks from medium armor',
      'Add up to +3 DEX modifier (instead of +2) when wearing medium armor',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Mobile',
    slug: 'mobile',
    description: 'You are exceptionally speedy and agile.',
    benefits: [
      'Speed increases by 10 feet',
      'When you Dash, difficult terrain doesn\'t cost extra movement',
      'When you make a melee attack against a creature, you don\'t provoke opportunity attacks from it',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Moderately Armored',
    slug: 'moderately-armored',
    prerequisite: 'Proficiency with light armor',
    description: 'You train to master medium armor and shields.',
    benefits: [
      'Increase Strength or Dexterity by 1',
      'Gain proficiency with medium armor and shields',
    ],
    source: 'PHB',
    halfFeat: 'str/dex',
    category: 'Combat',
  },
  {
    name: 'Mounted Combatant',
    slug: 'mounted-combatant',
    description: 'You are a dangerous foe while mounted.',
    benefits: [
      'Advantage on melee attacks against unmounted creatures smaller than your mount',
      'Can force attacks targeting your mount to target you instead',
      'Mount takes no damage on successful DEX saves (half on failure)',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Observant',
    slug: 'observant',
    description: 'Quick to notice details, you gain perceptive benefits.',
    benefits: [
      'Increase Intelligence or Wisdom by 1',
      '+5 bonus to passive Perception and passive Investigation',
      'Can read lips if you can see a creature\'s mouth and know the language',
    ],
    source: 'PHB',
    halfFeat: 'int/wis',
    category: 'Exploration',
  },
  {
    name: 'Polearm Master',
    slug: 'polearm-master',
    description: 'You master polearm fighting, gaining opportunity attacks and bonus attacks.',
    benefits: [
      'Bonus action: attack with opposite end of glaive, halberd, quarterstaff, or spear (1d4 bludgeoning)',
      'Creatures provoke opportunity attacks when entering your reach with these weapons',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Resilient',
    slug: 'resilient',
    description: 'Choose an ability score. You gain proficiency in saving throws using that ability.',
    benefits: [
      'Increase chosen ability score by 1',
      'Gain proficiency in saving throws using the chosen ability',
    ],
    source: 'PHB',
    halfFeat: 'any',
    category: 'Utility',
  },
  {
    name: 'Ritual Caster',
    slug: 'ritual-caster',
    prerequisite: 'Intelligence or Wisdom 13 or higher',
    description: 'You acquire a ritual book and can cast certain spells as rituals.',
    benefits: [
      'Choose a class: bard, cleric, druid, sorcerer, warlock, or wizard',
      'Acquire a ritual book with two 1st-level ritual spells',
      'Can cast spells in the book as rituals',
      'Can copy ritual spells you find into the book',
    ],
    source: 'PHB',
    category: 'Spellcasting',
  },
  {
    name: 'Savage Attacker',
    slug: 'savage-attacker',
    description: 'Once per turn, you can reroll melee weapon damage dice and use either total.',
    benefits: [
      'Once per turn, reroll melee weapon damage and use either result',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Sentinel',
    slug: 'sentinel',
    description: 'You master techniques to take advantage of every drop in enemy guard.',
    benefits: [
      'Creatures you hit with opportunity attacks have speed reduced to 0',
      'Creatures provoke opportunity attacks even if they Disengage',
      'Reaction: melee attack when creature within 5 ft attacks a target other than you',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Sharpshooter',
    slug: 'sharpshooter',
    description: 'You are a master of ranged weapons, able to make shots others find impossible.',
    benefits: [
      'No disadvantage on ranged attacks at long range',
      'Ranged attacks ignore half and three-quarters cover',
      'Before attacking: take -5 to hit for +10 damage with ranged weapons',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Shield Master',
    slug: 'shield-master',
    description: 'You use shields not just for protection but also for offense.',
    benefits: [
      'Bonus action: shove a creature within 5 feet after taking the Attack action',
      'Add shield\'s AC bonus to DEX saves against effects targeting only you',
      'If you succeed on a DEX save for half damage, use reaction to take no damage instead',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'Skilled',
    slug: 'skilled',
    description: 'You gain proficiency in any combination of three skills or tools.',
    benefits: [
      'Gain proficiency in any combination of three skills or tools of your choice',
    ],
    source: 'PHB',
    category: 'Utility',
  },
  {
    name: 'Skulker',
    slug: 'skulker',
    prerequisite: 'Dexterity 13 or higher',
    description: 'You are expert at slinking through shadows.',
    benefits: [
      'Can try to hide when lightly obscured',
      'Missed ranged attacks don\'t reveal your position',
      'Dim light doesn\'t impose disadvantage on Perception checks',
    ],
    source: 'PHB',
    category: 'Exploration',
  },
  {
    name: 'Spell Sniper',
    slug: 'spell-sniper',
    prerequisite: 'Spellcasting feature',
    description: 'You have learned techniques to enhance your attacks with certain spells.',
    benefits: [
      'Double range of spells that require an attack roll',
      'Ranged spell attacks ignore half and three-quarters cover',
      'Learn one cantrip that requires an attack roll (any class list)',
    ],
    source: 'PHB',
    category: 'Spellcasting',
  },
  {
    name: 'Tavern Brawler',
    slug: 'tavern-brawler',
    description: 'Accustomed to rough-and-tumble fighting using whatever is at hand.',
    benefits: [
      'Increase Strength or Constitution by 1',
      'Proficient with improvised weapons',
      'Unarmed strike deals 1d4 + STR damage',
      'Bonus action: grapple after hitting with unarmed strike or improvised weapon',
    ],
    source: 'PHB',
    halfFeat: 'str/con',
    category: 'Combat',
  },
  {
    name: 'Tough',
    slug: 'tough',
    description: 'Your hit point maximum increases dramatically.',
    benefits: [
      'HP maximum increases by twice your level',
      'Each time you gain a level, HP maximum increases by 2 additional HP',
    ],
    source: 'PHB',
    category: 'Combat',
  },
  {
    name: 'War Caster',
    slug: 'war-caster',
    prerequisite: 'Spellcasting feature',
    description: 'You have practiced casting spells in the midst of combat.',
    benefits: [
      'Advantage on CON saves to maintain concentration when taking damage',
      'Can perform somatic components with hands full (weapons/shield)',
      'Can cast a spell as an opportunity attack instead of melee',
    ],
    source: 'PHB',
    category: 'Spellcasting',
  },
  {
    name: 'Weapon Master',
    slug: 'weapon-master',
    description: 'You have practiced extensively with a variety of weapons.',
    benefits: [
      'Increase Strength or Dexterity by 1',
      'Gain proficiency with four weapons of your choice',
    ],
    source: 'PHB',
    halfFeat: 'str/dex',
    category: 'Combat',
  },

  // ── Tasha's Cauldron of Everything Feats ──
  {
    name: 'Artificer Initiate',
    slug: 'artificer-initiate',
    description: 'You\'ve learned some of an artificer\'s inventiveness.',
    benefits: [
      'Learn one cantrip and one 1st-level spell from the Artificer list',
      'Cast the spell once per long rest without a slot (INT is spellcasting ability)',
      'Gain proficiency with one type of artisan\'s tools',
      'Can use those tools as a spellcasting focus',
    ],
    source: 'TCE',
    category: 'Spellcasting',
  },
  {
    name: 'Chef',
    slug: 'chef',
    description: 'Time spent mastering the culinary arts has paid off.',
    benefits: [
      'Increase Constitution or Wisdom by 1',
      'Gain proficiency with cook\'s utensils (or expertise if already proficient)',
      'During short rest: cook special food restoring 1d8 extra HP to those who spend hit dice',
      'During long rest: prepare treats (proficiency bonus count) granting temp HP equal to proficiency bonus',
    ],
    source: 'TCE',
    halfFeat: 'con/wis',
    category: 'Utility',
  },
  {
    name: 'Crusher',
    slug: 'crusher',
    description: 'You are practiced in dealing bludgeoning damage.',
    benefits: [
      'Increase Strength or Constitution by 1',
      'Once per turn: move creature 5 ft when dealing bludgeoning damage (not to a size larger than you)',
      'On a critical hit with bludgeoning damage: all attacks against that creature have advantage until your next turn start',
    ],
    source: 'TCE',
    halfFeat: 'str/con',
    category: 'Combat',
  },
  {
    name: 'Eldritch Adept',
    slug: 'eldritch-adept',
    prerequisite: 'Spellcasting or Pact Magic feature',
    description: 'You learn one Eldritch Invocation from the warlock class.',
    benefits: [
      'Learn one Eldritch Invocation that has no prerequisites',
      'Can replace the invocation when you gain a level',
      'If the invocation has a prerequisite, you must be a Warlock to take it',
    ],
    source: 'TCE',
    category: 'Spellcasting',
  },
  {
    name: 'Fey Touched',
    slug: 'fey-touched',
    description: 'Your exposure to the Feywild\'s magic has changed you.',
    benefits: [
      'Increase Intelligence, Wisdom, or Charisma by 1',
      'Learn Misty Step and one 1st-level divination or enchantment spell',
      'Can cast each once per long rest without a slot',
      'Can also cast them using spell slots you have',
    ],
    source: 'TCE',
    halfFeat: 'int/wis/cha',
    category: 'Spellcasting',
  },
  {
    name: 'Fighting Initiate',
    slug: 'fighting-initiate',
    prerequisite: 'Proficiency with a martial weapon',
    description: 'You adopt a fighting style from the fighter class.',
    benefits: [
      'Learn one Fighting Style option from the Fighter class',
      'Can replace it when you gain a level',
      'Cannot take a Fighting Style you already have',
    ],
    source: 'TCE',
    category: 'Combat',
  },
  {
    name: 'Gunner',
    slug: 'gunner',
    description: 'You have a quick hand and keen eye for firearms.',
    benefits: [
      'Increase Dexterity by 1',
      'Gain proficiency with firearms',
      'Ignore the loading property of firearms',
      'No disadvantage on ranged attacks within 5 feet of a hostile creature',
    ],
    source: 'TCE',
    halfFeat: 'dex',
    category: 'Combat',
  },
  {
    name: 'Metamagic Adept',
    slug: 'metamagic-adept',
    prerequisite: 'Spellcasting or Pact Magic feature',
    description: 'You learn to exert your will on your spells to alter how they function.',
    benefits: [
      'Learn two Metamagic options from the Sorcerer class',
      'Gain 2 sorcery points to spend on Metamagic (recharge on long rest)',
      'Can only use one Metamagic option per spell unless noted otherwise',
    ],
    source: 'TCE',
    category: 'Spellcasting',
  },
  {
    name: 'Piercer',
    slug: 'piercer',
    description: 'You are practiced in dealing piercing damage.',
    benefits: [
      'Increase Strength or Dexterity by 1',
      'Once per turn: reroll one damage die when dealing piercing damage and use the new roll',
      'On a critical hit with piercing damage: roll one additional damage die',
    ],
    source: 'TCE',
    halfFeat: 'str/dex',
    category: 'Combat',
  },
  {
    name: 'Poisoner',
    slug: 'poisoner',
    description: 'You can prepare and deliver deadly poisons.',
    benefits: [
      'Proficient with the poisoner\'s kit',
      'Can apply poison as a bonus action',
      'Ignore resistance to poison damage from your poisons',
      'Can spend 50 gp and 1 hour to create potent poison (proficiency bonus doses)',
    ],
    source: 'TCE',
    category: 'Combat',
  },
  {
    name: 'Shadow Touched',
    slug: 'shadow-touched',
    description: 'Your exposure to the Shadowfell\'s magic has changed you.',
    benefits: [
      'Increase Intelligence, Wisdom, or Charisma by 1',
      'Learn Invisibility and one 1st-level illusion or necromancy spell',
      'Can cast each once per long rest without a slot',
      'Can also cast them using spell slots you have',
    ],
    source: 'TCE',
    halfFeat: 'int/wis/cha',
    category: 'Spellcasting',
  },
  {
    name: 'Skill Expert',
    slug: 'skill-expert',
    description: 'You have honed your proficiency with particular skills.',
    benefits: [
      'Increase one ability score by 1',
      'Gain proficiency in one skill of your choice',
      'Choose one skill you are proficient in: gain expertise (double proficiency bonus)',
    ],
    source: 'TCE',
    halfFeat: 'any',
    category: 'Utility',
  },
  {
    name: 'Slasher',
    slug: 'slasher',
    description: 'You are practiced in dealing slashing damage.',
    benefits: [
      'Increase Strength or Dexterity by 1',
      'Once per turn: reduce speed of creature you deal slashing damage to by 10 ft until your next turn start',
      'On a critical hit with slashing damage: target has disadvantage on all attacks until your next turn start',
    ],
    source: 'TCE',
    halfFeat: 'str/dex',
    category: 'Combat',
  },
  {
    name: 'Telekinetic',
    slug: 'telekinetic',
    description: 'You learn to move things with your mind.',
    benefits: [
      'Increase Intelligence, Wisdom, or Charisma by 1',
      'Learn Mage Hand cantrip (invisible, if already known increase range by 30 ft)',
      'Bonus action: shove one creature within 30 ft 5 feet toward or away from you (STR save)',
    ],
    source: 'TCE',
    halfFeat: 'int/wis/cha',
    category: 'Spellcasting',
  },
  {
    name: 'Telepathic',
    slug: 'telepathic',
    description: 'You awaken the ability to mentally connect with others.',
    benefits: [
      'Increase Intelligence, Wisdom, or Charisma by 1',
      'Telepathically speak to creatures within 60 ft (must share a language)',
      'Can cast Detect Thoughts once per long rest without a slot',
    ],
    source: 'TCE',
    halfFeat: 'int/wis/cha',
    category: 'Spellcasting',
  },

  // ── Xanathar's Guide Feats ──
  {
    name: 'Bountiful Luck',
    slug: 'bountiful-luck',
    prerequisite: 'Halfling',
    description: 'Your people have extraordinary luck that you share with companions.',
    benefits: [
      'When an ally within 30 ft rolls a 1 on an attack, check, or save: use reaction to let them reroll',
    ],
    source: 'XGE',
    category: 'Racial',
  },
  {
    name: 'Dragon Fear',
    slug: 'dragon-fear',
    prerequisite: 'Dragonborn',
    description: 'You can channel your draconic breath into a terrifying roar.',
    benefits: [
      'Increase Strength, Constitution, or Charisma by 1',
      'Instead of exhaling destructive energy, roar and force each creature of choice within 30 ft to make WIS save or be frightened for 1 minute',
    ],
    source: 'XGE',
    halfFeat: 'str/con/cha',
    category: 'Racial',
  },
  {
    name: 'Dragon Hide',
    slug: 'dragon-hide',
    prerequisite: 'Dragonborn',
    description: 'You manifest scales and claws reminiscent of your draconic ancestors.',
    benefits: [
      'Increase Strength, Constitution, or Charisma by 1',
      'Retractable claws: natural weapon dealing 1d4 + STR slashing damage',
      'AC = 13 + DEX modifier when not wearing armor',
    ],
    source: 'XGE',
    halfFeat: 'str/con/cha',
    category: 'Racial',
  },
  {
    name: 'Drow High Magic',
    slug: 'drow-high-magic',
    prerequisite: 'Elf (drow)',
    description: 'You learn more of the magic typical of dark elves.',
    benefits: [
      'Learn Detect Magic (cast at will)',
      'Learn Levitate and Dispel Magic (cast once per long rest each)',
      'Charisma is your spellcasting ability for these',
    ],
    source: 'XGE',
    category: 'Racial',
  },
  {
    name: 'Elven Accuracy',
    slug: 'elven-accuracy',
    prerequisite: 'Elf or half-elf',
    description: 'The accuracy of elves is legendary.',
    benefits: [
      'Increase Dexterity, Intelligence, Wisdom, or Charisma by 1',
      'When you have advantage on an attack using DEX, INT, WIS, or CHA: reroll one of the dice once',
    ],
    source: 'XGE',
    halfFeat: 'dex/int/wis/cha',
    category: 'Racial',
  },
  {
    name: 'Fade Away',
    slug: 'fade-away',
    prerequisite: 'Gnome',
    description: 'Your people are clever, with a knack for illusion magic.',
    benefits: [
      'Increase Dexterity or Intelligence by 1',
      'Reaction when you take damage: turn invisible until end of next turn or until you attack/cast a spell',
      'Once per short or long rest',
    ],
    source: 'XGE',
    halfFeat: 'dex/int',
    category: 'Racial',
  },
  {
    name: 'Flames of Phlegethos',
    slug: 'flames-of-phlegethos',
    prerequisite: 'Tiefling',
    description: 'You learn to call on hellfire to serve your commands.',
    benefits: [
      'Increase Intelligence or Charisma by 1',
      'Reroll any 1s on fire damage dice for spells you cast',
      'When you cast a fire damage spell: wreath yourself in flames until end of next turn (1d4 fire to those hitting you in melee)',
    ],
    source: 'XGE',
    halfFeat: 'int/cha',
    category: 'Racial',
  },
  {
    name: 'Infernal Constitution',
    slug: 'infernal-constitution',
    prerequisite: 'Tiefling',
    description: 'Fiendish blood runs strong in you.',
    benefits: [
      'Increase Constitution by 1',
      'Resistance to cold damage and poison damage',
      'Advantage on saving throws against being poisoned',
    ],
    source: 'XGE',
    halfFeat: 'con',
    category: 'Racial',
  },
  {
    name: 'Orcish Fury',
    slug: 'orcish-fury',
    prerequisite: 'Half-orc',
    description: 'Your inner fury burns tirelessly.',
    benefits: [
      'Increase Strength or Constitution by 1',
      'Once per short/long rest: +1 weapon damage die on a hit',
      'Reaction after using Relentless Endurance: make one weapon attack',
    ],
    source: 'XGE',
    halfFeat: 'str/con',
    category: 'Racial',
  },
  {
    name: 'Prodigy',
    slug: 'prodigy',
    prerequisite: 'Half-elf, half-orc, or human',
    description: 'You have a knack for learning new things.',
    benefits: [
      'Gain one skill proficiency, one tool proficiency, and one language of your choice',
      'Gain expertise in one skill you are proficient in',
    ],
    source: 'XGE',
    category: 'Racial',
  },
  {
    name: 'Second Chance',
    slug: 'second-chance',
    prerequisite: 'Halfling',
    description: 'Fortune favors you when someone tries to strike you.',
    benefits: [
      'Increase Dexterity, Constitution, or Charisma by 1',
      'Reaction when hit by attack: force reroll (must use new roll). Once per short/long rest',
    ],
    source: 'XGE',
    halfFeat: 'dex/con/cha',
    category: 'Racial',
  },
  {
    name: 'Squat Nimbleness',
    slug: 'squat-nimbleness',
    prerequisite: 'Dwarf or Small race',
    description: 'You are uncommonly nimble for your race.',
    benefits: [
      'Increase Strength or Dexterity by 1',
      'Walking speed increases by 5 feet',
      'Proficiency in Acrobatics or Athletics',
      'Advantage on checks to escape grapples',
    ],
    source: 'XGE',
    halfFeat: 'str/dex',
    category: 'Racial',
  },
  {
    name: 'Wood Elf Magic',
    slug: 'wood-elf-magic',
    prerequisite: 'Elf (wood)',
    description: 'You learn the magic of the primeval woods.',
    benefits: [
      'Learn one druid cantrip of your choice',
      'Learn Longstrider and Pass Without Trace (cast once per long rest each)',
      'Wisdom is your spellcasting ability for these spells',
    ],
    source: 'XGE',
    category: 'Racial',
  },
  {
    name: 'Dwarven Fortitude',
    slug: 'dwarven-fortitude',
    prerequisite: 'Dwarf',
    description: 'You have the blood of dwarf heroes flowing through your veins.',
    benefits: [
      'Increase Constitution by 1',
      'When you take the Dodge action, you can spend one hit die to heal yourself (roll the die, add CON modifier, regain that many HP)',
    ],
    source: 'XGE',
    halfFeat: 'con',
    category: 'Racial',
  },
  {
    name: 'Fey Teleportation',
    slug: 'fey-teleportation',
    prerequisite: 'Elf (high)',
    description: 'Your study of high elven lore has unlocked fey power that few other elves possess.',
    benefits: [
      'Increase Intelligence or Charisma by 1',
      'Learn the Sylvan language',
      'Learn Misty Step, which you can cast once per short or long rest without a spell slot',
      'Intelligence is your spellcasting ability for Misty Step',
    ],
    source: 'XGE',
    halfFeat: 'int/cha',
    category: 'Racial',
  },
  {
    name: 'Svirfneblin Magic',
    slug: 'svirfneblin-magic',
    prerequisite: 'Gnome (deep/svirfneblin)',
    description: 'You have inherited the innate spellcasting ability of your ancestors.',
    benefits: [
      'Can cast Nondetection at will on yourself without a spell slot or material components',
      'Can cast Blindness/Deafness, Blur, and Disguise Self once each per long rest without a spell slot',
      'Intelligence is your spellcasting ability for these spells',
    ],
    source: 'XGE',
    category: 'Racial',
  },

  // ── Fizban's Treasury of Dragons Feats ──
  {
    name: 'Gift of the Chromatic Dragon',
    slug: 'gift-of-the-chromatic-dragon',
    description: 'You have manifested some of the power of chromatic dragons, granting you elemental resilience and infusing your strikes with elemental energy.',
    benefits: [
      'Chromatic Infusion: As a bonus action, touch a simple or martial weapon and infuse it with acid, cold, fire, lightning, or poison. For 1 minute, it deals an extra 1d4 damage of the chosen type on a hit. Once per long rest',
      'Reactive Resistance: When you take acid, cold, fire, lightning, or poison damage, use your reaction to give yourself resistance to that damage type until the end of your next turn. Proficiency bonus uses per long rest',
    ],
    source: 'FToD',
    category: 'Combat',
  },
  {
    name: 'Gift of the Gem Dragon',
    slug: 'gift-of-the-gem-dragon',
    description: 'You have manifested some of the power of gem dragons, granting you telekinetic abilities and a protective reaction.',
    benefits: [
      'Increase Intelligence, Wisdom, or Charisma by 1',
      'Telekinetic Reprisal: When you take damage from a creature within 10 ft, use reaction to force a STR save (DC = 8 + prof + ability modifier). On failure, creature takes 2d8 force damage and is pushed 10 ft. On success, half damage and no push. Damage increases to 3d8 at 5th, 4d8 at 11th, 5d8 at 17th level. Proficiency bonus uses per long rest',
    ],
    source: 'FToD',
    halfFeat: 'int/wis/cha',
    category: 'Combat',
  },
  {
    name: 'Gift of the Metallic Dragon',
    slug: 'gift-of-the-metallic-dragon',
    description: 'You have manifested some of the power of metallic dragons, granting you protective and curative abilities.',
    benefits: [
      'Draconic Healing: Learn Cure Wounds. Can cast once per long rest without a spell slot. Can also cast using spell slots. Spellcasting ability is INT, WIS, or CHA (chosen when you take the feat)',
      'Protective Wings: When you or a creature within 5 ft is hit by an attack, use your reaction to manifest spectral wings and add your proficiency bonus to the target\'s AC, potentially turning the hit into a miss. Proficiency bonus uses per long rest',
    ],
    source: 'FToD',
    category: 'Utility',
  },

  // ── Dragonlance Setting Feats ──
  {
    name: 'Kender Nightstalker',
    slug: 'kender-nightstalker',
    prerequisite: 'Kender',
    description: 'You have developed an eerie connection to the spirits of the dead, granting you heightened perception in haunted places.',
    benefits: [
      'Increase Wisdom by 1',
      'Advantage on Wisdom (Perception) checks in enclosed areas where 5 or more creatures have died, as lingering essences whisper secrets of the surroundings',
      'Learn Speak with Dead, which you can cast once per long rest without a spell slot or material components',
    ],
    source: 'DL',
    halfFeat: 'wis',
    category: 'Racial',
  },
  {
    name: 'Draconian Breath Weapon',
    slug: 'draconian-breath-weapon',
    prerequisite: 'Draconian',
    description: 'You can exhale destructive energy, channeling the power of the dragon whose egg you were corrupted from.',
    benefits: [
      'Gain a breath weapon usable as an action. DC = 8 + CON modifier + proficiency bonus',
      'Base damage: 2d6, increasing to 3d6 at 6th level, 4d6 at 11th level, 5d6 at 16th level',
      'Baaz: 5×30 ft line of fire (DEX save). Kapak: 5×30 ft line of acid (DEX save). Bozak: 5×30 ft line of lightning (DEX save)',
      'Sivak: 15 ft cone of cold (CON save). Aurak: 15 ft cone of fire (DEX save)',
      'Recharges on a short or long rest',
    ],
    source: 'DL',
    category: 'Racial',
  },
];

// ── Helper Functions ──
export function getFeatBySlug(slug: string): Feat | undefined {
  return feats.find(f => f.slug === slug);
}

export function getFeatByName(name: string): Feat | undefined {
  return feats.find(f => f.name.toLowerCase() === name.toLowerCase());
}

export function getFeatsByCategory(category: string): Feat[] {
  return feats.filter(f => f.category === category);
}

export function getFeatsBySource(source: string): Feat[] {
  return feats.filter(f => f.source === source);
}

export const featCategories = [...new Set(feats.map(f => f.category))].sort();
export const featSources = [...new Set(feats.map(f => f.source))].sort();
